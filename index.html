<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Robux Order</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="script.js" defer></script>
    <style>body { background: linear-gradient(135deg, #0a0a0a, #1a1a2e); }</style>
</head>
<body class="min-h-screen text-white flex items-center justify-center">
    <div class="w-full max-w-md p-8 bg-zinc-900 rounded-3xl shadow-2xl">
        <div class="text-center mb-10">
            <h1 class="text-4xl font-bold text-cyan-400">ROBUX ORDER</h1>
            <p class="text-zinc-400 mt-2">Quản lý đơn hàng nhanh</p>
        </div>

        <div class="flex mb-8 bg-zinc-800 rounded-full p-1">
            <button id="loginTab" class="flex-1 py-3 rounded-full font-medium bg-zinc-900 text-white">Đăng nhập</button>
            <button id="registerTab" class="flex-1 py-3 rounded-full font-medium">Đăng ký</button>
        </div>

        <div id="loginForm">
            <input id="loginUsername" type="text" placeholder="Tên đăng nhập" class="w-full mb-4 bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-cyan-500">
            <input id="loginPassword" type="password" placeholder="Mật khẩu" class="w-full mb-6 bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-cyan-500">
            <button onclick="handleLogin()" class="w-full bg-cyan-500 hover:bg-cyan-600 py-4 rounded-2xl font-bold">Đăng nhập</button>
        </div>

        <div id="registerForm" class="hidden">
            <input id="regUsername" type="text" placeholder="Tên đăng nhập" class="w-full mb-4 bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-cyan-500">
            <input id="regPassword" type="password" placeholder="Mật khẩu" class="w-full mb-4 bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-cyan-500">
            <input id="regConfirm" type="password" placeholder="Nhập lại mật khẩu" class="w-full mb-4 bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 focus:outline-none focus:border-cyan-500">
            <div class="mb-6">
                <label class="block text-sm text-zinc-400 mb-2">Ảnh đại diện (tùy chọn)</label>
                <input id="regAvatar" type="file" accept="image/*" class="w-full bg-zinc-800 border border-zinc-700 rounded-xl px-5 py-4 text-zinc-400">
            </div>
            <button onclick="handleRegister()" class="w-full bg-cyan-500 hover:bg-cyan-600 py-4 rounded-2xl font-bold">Tạo tài khoản</button>
        </div>
    </div>

    <script>
        document.getElementById('loginTab').onclick = () => {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginTab').classList.add('bg-zinc-900', 'text-white');
            document.getElementById('registerTab').classList.remove('bg-zinc-900', 'text-white');
        };
        document.getElementById('registerTab').onclick = () => {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('registerTab').classList.add('bg-zinc-900', 'text-white');
            document.getElementById('loginTab').classList.remove('bg-zinc-900', 'text-white');
        };

        function handleLogin() {
            const u = document.getElementById('loginUsername').value.trim();
            const p = document.getElementById('loginPassword').value;
            if (login(u, p)) {
                window.location.href = currentRole === 'admin' ? 'admin.html' : 'dashboard.html';
            } else {
                alert('Sai tên hoặc mật khẩu!');
            }
        }

        async function handleRegister() {
            const u = document.getElementById('regUsername').value.trim();
            const p = document.getElementById('regPassword').value;
            const c = document.getElementById('regConfirm').value;
            const file = document.getElementById('regAvatar').files[0];

            if (!u || !p) return alert('Điền đầy đủ!');
            if (p !== c) return alert('Mật khẩu không khớp!');

            let avatar = '';
            if (file) {
                avatar = await new Promise(r => {
                    const reader = new FileReader();
                    reader.onload = () => r(reader.result);
                    reader.readAsDataURL(file);
                });
            }

            if (register(u, p)) {
                if (avatar) updateAvatar(avatar);
                alert('Đăng ký thành công!');
                login(u, p);
                window.location.href = 'dashboard.html';
            }
        }
    </script>
</body>
</html>